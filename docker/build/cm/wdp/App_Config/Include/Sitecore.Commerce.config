<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
  <sitecore>
    <!--  ENTITY FACTORY
          Creates an entity by entity name. Allows to substitute default entity with extended one.
    -->
    <entityFactory type="Sitecore.Commerce.Entities.EntityFactory, Sitecore.Commerce.Connect.Core" singleInstance="true" />

    <contactFactory type="Sitecore.Commerce.Contacts.ContactFactory, Sitecore.Commerce.Connect.Core" />

    <itemClassificationService type="Sitecore.Commerce.Products.ItemClassificationService, Sitecore.Commerce.Connect.Core" singleInstance="true" />

    <shopProvider type="Sitecore.Commerce.Providers.ShopProvider, Sitecore.Commerce.Connect.Core" singleInstance="true"/>

    <authenticationTokenProvider type="Sitecore.Commerce.Providers.AuthenticationTokenProvider, Sitecore.Commerce.Connect.Core" singleInstance="true"/>

    <connectStorefrontContext type="Sitecore.Commerce.Multishop.ConnectStorefrontContext, Sitecore.Commerce.Connect.Core"/>

    <requestCurrencyCodeProvider type="Sitecore.Commerce.Providers.RequestCurrencyProvider, Sitecore.Commerce.Connect.Core" singleInstance="true"/>

    <md5Generator type="Sitecore.Commerce.Utils.Md5Generator, Sitecore.Commerce.Connect.Core" singleInstance="true"/>

    <platformCommerceTracker type="Sitecore.Commerce.Providers.PlatformTrackerProvider, Sitecore.Commerce.Connect.Core" singleInstance="true"/>
    <cookieCommerceTracker type="Sitecore.Commerce.Providers.CookieTrackerProvider, Sitecore.Commerce.Connect.Core" singleInstance="true"/>

    <updateContactInXdbProvider type="Sitecore.Commerce.Providers.UpdateContactInXdbProvider, Sitecore.Commerce.Connect.Core"/>
    
    <excludeUrlTracking>
    </excludeUrlTracking>

    <!-- Commonly shared Commerce entities -->
    <commerce.Entities>
      <Party type="Sitecore.Commerce.Entities.Party, Sitecore.Commerce.Connect.Core" />
      <SystemMessage type="Sitecore.Commerce.Services.SystemMessage, Sitecore.Commerce.Connect.Core" />
      <Shop type="Sitecore.Commerce.Entities.Shop, Sitecore.Commerce.Connect.Core" />
      <AuthenticationToken type="Sitecore.Commerce.Entities.AuthenticationToken, Sitecore.Commerce.Connect.Core" />
    </commerce.Entities>

    <commerce.analyticsData>
      <CartLinesAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartLinesAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CartLineAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartLineAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CartAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CartResumedAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartResumedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CartUpdatedAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartUpdatedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CustomerAnalyticsData type="Sitecore.Commerce.AnalyticsData.CustomerAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <UserAnalyticsData type="Sitecore.Commerce.AnalyticsData.UserAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CultureChosenAnalyticsData type="Sitecore.Commerce.AnalyticsData.CultureChosenAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <ProductsAreBackInStockAnalyticsData type="Sitecore.Commerce.AnalyticsData.ProductsAreBackInStockAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <BackInStockUnsubscriptionAnalyticsData type="Sitecore.Commerce.AnalyticsData.BackInStockUnsubscriptionAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitedProductStockStatusAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitedProductStockStatusAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <BackInStockSubscriptionAnalyticsData type="Sitecore.Commerce.AnalyticsData.BackInStockSubscriptionAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <LoyaltyProgramJoinedGoalAnalyticsData type="Sitecore.Commerce.AnalyticsData.LoyaltyProgramJoinedGoalAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitorViewedOrderDetailsAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitorViewedOrderDetailsAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitorViewedOrderHistoryAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitorViewedOrderHistoryAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <AddToCartStockStatusAnalyticsData type="Sitecore.Commerce.AnalyticsData.AddToCartStockStatusAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CartLineStockStatusAnalyticsData type="Sitecore.Commerce.AnalyticsData.CartLineStockStatusAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <OrderStatusChangedAnalyticsData type="Sitecore.Commerce.AnalyticsData.OrderStatusChangedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <GiftCardPurchaseAnalyticsData type="Sitecore.Commerce.AnalyticsData.GiftCardPurchaseAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <LoyaltyCardPurchaseAnalyticsData type="Sitecore.Commerce.AnalyticsData.LoyaltyCardPurchaseAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitorCancelOrderAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitorCancelOrderAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListCreatedAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListCreatedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListDeletedAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListDeletedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListsEmailedAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListsEmailedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListPrintedAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListPrintedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <LinesRemovedFromWishListAnalyticsData type="Sitecore.Commerce.AnalyticsData.LinesRemovedFromWishListAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <WishListLineAnalyticsData type="Sitecore.Commerce.AnalyticsData.WishListLineAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <LinesUpdatedOnWishListAnalyticsData type="Sitecore.Commerce.AnalyticsData.LinesUpdatedOnWishListAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <FacetAppliedAnalyticsData type="Sitecore.Commerce.AnalyticsData.FacetAppliedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <ProductSortingAnalyticsData type="Sitecore.Commerce.AnalyticsData.ProductSortingAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <SearchAnalyticsData type="Sitecore.Commerce.AnalyticsData.SearchAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitedCategoryPageAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitedCategoryPageAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <VisitedProductDetailsPageAnalyticsData type="Sitecore.Commerce.AnalyticsData.VisitedProductDetailsPageAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <OrderGoalAnalyticsData type="Sitecore.Commerce.AnalyticsData.OrderGoalAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <LinesAddedToWishListAnalyticsData type="Sitecore.Commerce.AnalyticsData.LinesAddedToWishListAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <CurrencyChosenAnalyticsData type="Sitecore.Commerce.AnalyticsData.CurrencyChosenAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <OfflineOrdersSynchronizedAnalyticsData type="Sitecore.Commerce.AnalyticsData.OfflineOrdersSynchronizedAnalyticsData, Sitecore.Commerce.Connect.Core"/>
      <ReorderAnalyticsData type="Sitecore.Commerce.AnalyticsData.ReorderAnalyticsData, Sitecore.Commerce.Connect.Core"/>
    </commerce.analyticsData>

    <commerce.outcomeData>
      <SubmittedOrderOutcomeData type="Sitecore.Commerce.OutcomeData.SubmittedOrderOutcomeData, Sitecore.Commerce.Connect.Core"/>
      <AbandonedCartOutcomeData type="Sitecore.Commerce.OutcomeData.AbandonedCartOutcomeData, Sitecore.Commerce.Connect.Core"/>
    </commerce.outcomeData>

    <settings>
      <!-- Value can be: Base, Custom, Both -->
      <setting name="Commerce.Analytics.EntitiesIncludedInXDB" value="Base"/>
    </settings>

    <pipelines>
      <startAnalytics>
        <processor patch:before="processor[@type='Sitecore.Analytics.Pipelines.StartAnalytics.CheckPreconditions, Sitecore.Analytics']" type="Sitecore.Commerce.Pipelines.StartsAnalytics.ExcludeUrlTracking, Sitecore.Commerce.Connect.Core"/>
      </startAnalytics>
    </pipelines>


    <services>
      
      <register
       serviceType="Sitecore.Commerce.Providers.IContactCommerceInteractionProvider, Sitecore.Commerce.Connect.Core"
       implementationType="Sitecore.Commerce.Providers.ContactCommerceInteractionProvider, Sitecore.Commerce.Connect.Core"
       lifetime="Singleton" />
      
      <register
        serviceType="Sitecore.Commerce.Utils.ICommerceContactService, Sitecore.Commerce.Connect.Core"
        implementationType="Sitecore.Commerce.Utils.CommerceContactService, Sitecore.Commerce.Connect.Core"
        lifetime="Singleton" />
      
      <register
         serviceType="Sitecore.Commerce.Services.Inventory.InventoryServiceProvider, Sitecore.Commerce.Connect.Core"
         implementationType= "Sitecore.Commerce.Services.Inventory.InventoryServiceProvider, Sitecore.Commerce.Connect.Core"
         lifetime="Singleton" />

      <register
          serviceType="Sitecore.Commerce.Multishop.CommerceContextBase, Sitecore.Commerce.Connect.Core"
          implementationType="Sitecore.Commerce.Multishop.CommerceContextBase, Sitecore.Commerce.Connect.Core"
          lifetime="Singleton" />

      <register
          serviceType="Sitecore.Commerce.IConnectContext, Sitecore.Commerce.Connect.Core"
          implementationType= "Sitecore.Commerce.DefaultConnectContext, Sitecore.Commerce.Connect.Core"
          lifetime="Singleton" />

      <register
        serviceType="Sitecore.Commerce.Providers.IShopProvider, Sitecore.Commerce.Connect.Core"
        implementationType="Sitecore.Commerce.Providers.ShopProvider, Sitecore.Commerce.Connect.Core"
        lifetime="Singleton" />

      <register
        serviceType="Sitecore.Commerce.Providers.IUpdateContactInXdbProvider, Sitecore.Commerce.Connect.Core"
        implementationType= "Sitecore.Commerce.Providers.UpdateContactInXdbProvider, Sitecore.Commerce.Connect.Core"
        lifetime="Singleton" />

      <register
        serviceType="Sitecore.Commerce.Entities.IEntityFactory, Sitecore.Commerce.Connect.Core"
        implementationType= "Sitecore.Commerce.Entities.EntityFactory, Sitecore.Commerce.Connect.Core"
        lifetime="Singleton" />

      <register
        serviceType="Sitecore.Commerce.Providers.IDomainProvider, Sitecore.Commerce.Connect.Core"
        implementationType= "Sitecore.Commerce.Providers.DomainProvider, Sitecore.Commerce.Connect.Core"
        lifetime="Singleton" />
    </services>
  </sitecore>
</configuration>
