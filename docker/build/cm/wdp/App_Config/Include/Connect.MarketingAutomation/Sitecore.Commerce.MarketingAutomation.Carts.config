<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
  <sitecore>

    <cartAutomationPlanCustomValueProvider type="Sitecore.Commerce.MarketingAutomation.Providers.CartAutomationPlanCustomValuesProvider, Sitecore.Commerce.Connect.MarketingAutomation" singleInstance="true" />

    <pipelines>

      <commerce.carts.addCartLines>
        <processor type="Sitecore.Commerce.MarketingAutomation.Pipelines.Carts.Common.UpdateVisitorInAutomationPlan, Sitecore.Commerce.Connect.MarketingAutomation">
          <param ref="cartAutomationPlanCustomValueProvider" />
          <basePlanName>Abandoned Cart</basePlanName>
          <allowDuplicateContacts>false</allowDuplicateContacts>
          <allowUnauthenticatedContacts>true</allowUnauthenticatedContacts>
        </processor>
      </commerce.carts.addCartLines>

      <commerce.carts.removeCartLines>
        <processor type="Sitecore.Commerce.MarketingAutomation.Pipelines.Carts.Common.UpdateVisitorInAutomationPlan, Sitecore.Commerce.Connect.MarketingAutomation">
          <param ref="cartAutomationPlanCustomValueProvider" />
          <basePlanName>Abandoned Cart</basePlanName>
          <allowDuplicateContacts>false</allowDuplicateContacts>
          <allowUnauthenticatedContacts>true</allowUnauthenticatedContacts>
        </processor>
      </commerce.carts.removeCartLines>

      <commerce.carts.updateCartLines>
        <processor type="Sitecore.Commerce.MarketingAutomation.Pipelines.Carts.Common.UpdateVisitorInAutomationPlan, Sitecore.Commerce.Connect.MarketingAutomation">
          <param ref="cartAutomationPlanCustomValueProvider" />
          <basePlanName>Abandoned Cart</basePlanName>
          <allowDuplicateContacts>false</allowDuplicateContacts>
          <allowUnauthenticatedContacts>true</allowUnauthenticatedContacts>
        </processor>
      </commerce.carts.updateCartLines>

    </pipelines>
  </sitecore>
</configuration>
